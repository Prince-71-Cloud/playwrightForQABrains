(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{276:(e,t,r)=>{"use strict";r.d(t,{ME:()=>d,Yc:()=>u,jw:()=>l,w:()=>c});var s=r(7383),n=r(2359),o=r(5357);let i=r(9509).env.SESSION_SECRET||"36YW<QhYc{iC9>6",a=new TextEncoder().encode(i),l=async e=>{try{let{accessToken:t="",tokenType:r="",expiresAt:n=new Date(Date.now()+2592e6)}=e,o=t;r&&(o="".concat(r," ").concat(t));let i=await c({authToken:o,expiresAt:n});return s.A.set("session",i,{expires:30})}catch(e){throw console.error(e,"Failed to create session"),Error("Auth generation is failed.")}};async function c(e){var t;let r=new Date(new Date().getTime()+2592e6),s=null!=(t=e.expiresAt)?t:r;return new n.P({authToken:e.authToken,expiresAt:s}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("30d").sign(a)}async function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(!e)return null;let{payload:t}=await (0,o.V)(e,a,{algorithms:["HS256"]});return t}catch(e){return console.error(e,"Failed to decrypt session"),null}}let d=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=window.location.hostname,r={path:"/",..."localhost"===t||"127.0.0.1"===t?{}:{domain:"."+t.split(".").slice(-2).join(".")}};try{return s.A.remove("access_token",{...r,secure:!0}),s.A.remove("access_token",r),s.A.remove("access_token"),s.A.remove("session",{...r,secure:!0}),s.A.remove("session",r),s.A.remove("session"),sessionStorage.clear(),"function"==typeof e&&e(),!0}catch(e){return console.error("Error removing cookies:",e),null}}},347:()=>{},1618:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(5155),n=r(2115),o=r(5695),i=r(3464),a=r(7383),l=r(276),c=r(5700);let u=e=>{let{children:t}=e,r=(0,o.useRouter)(),{resetAuth:u,auth:d}=(0,c.A)();return i.A.defaults.baseURL="https://admin.qabrains.com/api/v1",i.A.defaults.headers.common["ngrok-skip-browser-warning"]=!0,i.A.interceptors.request.use(e=>e,e=>{let{status:t=null}=(null==e?void 0:e.response)||{};return 401===t&&(0,l.ME)(()=>{u(),r.push("/")}),Promise.reject(e)}),(0,n.useEffect)(()=>{(async()=>{try{let e=a.A.get("session"),t=await (0,l.Yc)(e);e&&!t&&(0,l.ME)(()=>u()),i.A.defaults.headers.common.Authorization=(null==t?void 0:t.authToken)||""}catch(e){console.error("Error in CornerStone:",e)}})()},[d]),(0,s.jsx)(s.Fragment,{children:t})}},1985:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var s=r(5155),n=r(2115),o=r(8119);let i=e=>{let{children:t}=e;return(0,n.useEffect)(()=>{o.A.persist.rehydrate()},[]),(0,s.jsx)(s.Fragment,{children:t})}},5700:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(5453),n=r(6786);let o=(0,s.v)((0,n.lt)((0,n.Zr)(e=>({auth:{},isSidebarExpand:!1,removeAll:()=>e({bears:0}),setAuth:t=>e({auth:t}),resetAuth:()=>e({auth:{}}),setSidebarExpand:t=>e({isSidebarExpand:t})}),{name:"app-persisted-storage",skipHydration:!0,storage:(0,n.KU)(()=>localStorage)}),{name:"usePersistedStore"}))},6811:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var s=r(5155),n=r(2115),o=r(5695),i=r(7383),a=r(276),l=r(5700),c=r(3464);let u=e=>{let{children:t}=e,r=(0,o.usePathname)(),{resetAuth:u,auth:d,setAuth:h}=(0,l.A)(),m=async()=>{try{let e=i.A.get("access_token")||null;if(!e)return(0,a.ME)(()=>u());if(Object.entries(d).length)return;let{data:t={}}=(await c.A.get("https://admin.qabrains.com/api/v1/my-profile",{headers:{Authorization:"".concat(e)}})).data||{};await (0,a.jw)({accessToken:e}),h({...t})}catch(e){}};return(0,n.useEffect)(()=>{m()},[r]),!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=(0,n.useRef)(null);(0,n.useEffect)(()=>{let s=()=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{e()},t)},n=()=>{document.hidden||s()};return window.addEventListener("focus",s),document.addEventListener("visibilitychange",n),()=>{r.current&&clearTimeout(r.current),window.removeEventListener("focus",s),document.removeEventListener("visibilitychange",n)}},[e,t])}(()=>m()),(0,s.jsx)(s.Fragment,{children:t})}},7307:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>i});var s=r(5155),n=r(6671),o=r(1362);function i(){let{resolvedTheme:e}=(0,o.D)();return(0,s.jsx)(n.l$,{position:"top-center",richColors:!0,theme:e,toastOptions:{style:{borderRadius:6,overflow:"hidden",boxShadow:"rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 4px 13px -3px, rgba(0, 0, 0, 0.2) 0px -1px 0px inset"}}})}},7875:(e,t,r)=>{Promise.resolve().then(r.bind(r,6259)),Promise.resolve().then(r.bind(r,6063)),Promise.resolve().then(r.bind(r,8930)),Promise.resolve().then(r.bind(r,6083)),Promise.resolve().then(r.t.bind(r,9243,23)),Promise.resolve().then(r.t.bind(r,8256,23)),Promise.resolve().then(r.t.bind(r,3769,23)),Promise.resolve().then(r.t.bind(r,4638,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,7307)),Promise.resolve().then(r.bind(r,1618)),Promise.resolve().then(r.bind(r,8847)),Promise.resolve().then(r.bind(r,6811)),Promise.resolve().then(r.bind(r,1985))},8119:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(5453),n=r(6786),o=r(7383);let i=(0,s.v)()((0,n.lt)((0,n.Zr)((e,t)=>({auth:{ecom_token:"",email:"",password:""},wishlist:{},cart:{},setAuth:async t=>{try{if(await Promise.resolve().then(()=>o.A.set("ecom_token",t.ecom_token)),!o.A.get("ecom_token"))throw Error("Failed to set cookie for ecom access token");return e({auth:t}),t}catch(e){return console.error("Error in login:",e),e}},resetAuth:()=>{o.A.remove("ecom_token"),e({auth:{ecom_token:"",email:"",password:""}})},addWToWishlist:r=>{let s=t(),n=s.auth.email||"guest",o=s.wishlist[n]||[];o.includes(r)||e({wishlist:{...s.wishlist,[n]:[...o,r]}})},removeFromWishlist:r=>{let s=t(),n=s.auth.email||"guest",o=s.wishlist[n]||[];e({wishlist:{...s.wishlist,[n]:o.filter(e=>e!==r)}})},addToCart:r=>{let s,n=t(),o=n.auth.email||"guest",i=n.cart[o]||[],a=i.findIndex(e=>e.id===r.id);-1!==a?(s=[...i],s[a].quantity+=1):s=[...i,{...r,quantity:1}],e({cart:{...n.cart,[o]:s}})},deductFromCart:r=>{let s=t(),n=s.auth.email||"guest",o=(s.cart[n]||[]).map(e=>e.id===r?{...e,quantity:e.quantity-1}:e).filter(e=>e.quantity>0);e({cart:{...s.cart,[n]:o}})},removeFromCart:r=>{let s=t(),n=s.auth.email||"guest",o=s.cart[n]||[];e({cart:{...s.cart,[n]:o.filter(e=>e.id!==r)}})},resetCart:()=>{let r=t(),s=r.auth.email||"guest";e({cart:{...r.cart,[s]:[]}})}}),{name:"ecom-persisted-storage",storage:(0,n.KU)(()=>localStorage)}),{name:"useEcomStore"}))},8847:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var s=r(5155),n=r(2115),o=r(1362);let i=e=>{let{children:t}=e,[r,i]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{i(!0)},[]),r)?(0,s.jsx)(o.N,{children:t}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[3383,8818,6671,3464,6251,8881,8441,1684,7358],()=>t(7875)),_N_E=e.O()}]);