"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1368],{41368:function(e,t,n){n.r(t),n.d(t,{default:function(){return SocialLogin_GoogleSingleTapLogin}});var o=n(85893),r=n(67294),__assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i="__googleOneTapScript__",s=(0,r.memo)(function(e){var t,n,o,s,a,l,c,u,d,g,v,f,p=e.children;return n=(t=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&0>t.indexOf(o)&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)0>t.indexOf(o[r])&&(n[o[r]]=e[o[r]]);return n}(e,["children"])).onError,o=t.disabled,s=t.onSuccess,a=t.googleAccountConfigs,c=void 0!==(l=t.disableCancelOnUnmount)&&l,u="https://accounts.google.com/gsi/client",g=(d=(0,r.useState)(u?"loading":"idle"))[0],v=d[1],(0,r.useEffect)(function(){if(!u){v("idle");return}var e=document.querySelector('script[src="'+u+'"]');if(e)v(e.getAttribute("data-status")||"idle");else{(e=document.createElement("script")).src=u,e.async=!0,e.setAttribute("data-status","loading"),document.body.appendChild(e);var setAttributeFromEvent=function(t){e&&e.setAttribute("data-status","load"===t.type?"ready":"error")};e.addEventListener("load",setAttributeFromEvent),e.addEventListener("error",setAttributeFromEvent)}var setStateFromEvent=function(e){v("load"===e.type?"ready":"error")};return e.addEventListener("load",setStateFromEvent),e.addEventListener("error",setStateFromEvent),function(){e&&(e.removeEventListener("load",setStateFromEvent),e.removeEventListener("error",setStateFromEvent))}},[u]),f=a.callback?a.callback:function(e){var t,o,r,i;return o=(t={data:e,onError:n,onSuccess:s}).data,r=t.onError,i=t.onSuccess,void((null==o?void 0:o.credential)&&fetch("https://oauth2.googleapis.com/tokeninfo?id_token="+o.credential).then(function(e){if((null==e?void 0:e.status)===200&&(null==e?void 0:e.json))return e.json();throw r&&r(),Error("Something went wrong")}).then(function(e){i&&i(e)}).catch(function(e){throw r&&r(e),e}))},(0,r.useEffect)(function(){if((null==window?void 0:window[i])||!window.google||"ready"!==g||(window.google.accounts.id.initialize(__assign(__assign({},a),{callback:f})),window[i]=!0),(null==window?void 0:window[i])&&"ready"===g&&!o)return window.google.accounts.id.prompt(),function(){c||window.google.accounts.id.cancel()}},[g,null==window?void 0:window[i],o]),void 0===p?null:p}),a=n(15305),l=n(22920),c=n(53626),u=n(83684),d=n(11163),g=n(9473),v=n(96486),f=n.n(v),p=n(5121),SocialLogin_GoogleSingleTapLogin=()=>{let e=(0,d.useRouter)(),t=(0,g.I0)(),n=(0,g.v9)(e=>{var t;return null==e?void 0:null===(t=e.userReducer)||void 0===t?void 0:t.loggedUser}),[i,v]=(0,r.useState)(0),signInWithGoogleOneTab=async function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!f().isEmpty(n))try{let o=await p.Z.post("/login-social-one-tap",n),{api_token:r,data:i,message:s}=null==o?void 0:o.data;(0,c.HF)(l.Am,"success",s),u.Z.login(()=>{u.Z.setTokenToCookie(r,(null==i?void 0:i.token_type)||"Bearer",365),t((0,a.JR)(i));let n=sessionStorage.getItem("redirectURI");sessionStorage.removeItem("redirectURI"),n?setTimeout(()=>e.push(n),300):setTimeout(()=>e.push("/profile/"+(null==i?void 0:i.slug)),300)})}catch(e){(0,c.HF)(l.Am,"error",e)}};return(0,r.useEffect)(()=>{v(e=>e+1)},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(s,{disabled:!f().isEmpty(n),onError:e=>{(0,c.HF)(l.Am,"error",e)},onSuccess:e=>signInWithGoogleOneTab(e),googleAccountConfigs:{cancel_on_tap_outside:!0,client_id:"759011154179-vvljc2otn2t1nkfpd3vrh4l00hcrg5nf.apps.googleusercontent.com"}},i)})}}}]);